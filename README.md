# ğŸ” ë©€í‹°ëª¨ë‹¬ RAG ê²€ìƒ‰ ì‹œìŠ¤í…œ

Jina CLIP v2 ì„ë² ë”©ê³¼ êµ¬ê¸€ Firestore ë²¡í„° DBë¥¼ ì´ìš©í•´ **í…ìŠ¤íŠ¸Â·ì´ë¯¸ì§€Â·ë©€í‹°ëª¨ë‹¬** ê²€ìƒ‰ì„
ì§€ì›í•˜ëŠ” ìŠ¤íŠ¸ë¦¼ë¦¿ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
./
â”œâ”€â”€ firestore_vector_db.py.     # Firestore ë²¡í„° DB CRUD ë° ê²€ìƒ‰
â”œâ”€â”€ key/
â”‚   â””â”€â”€ key.json                # Firebase í‚¤ íŒŒì¼
â”œâ”€â”€ jina_clip_embedding.py.     # CLIP ëª¨ë¸ ë¡œë“œ ë° ì„ë² ë”©
â”œâ”€â”€ multimodal_rag_system.py.   # í…ìŠ¤íŠ¸Â·ì´ë¯¸ì§€Â·ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ ë¡œì§
â”œâ”€â”€ .env                        # í™˜ê²½ ë³€ìˆ˜ ì €ì¥ìš© íŒŒì¼
â”œâ”€â”€ requirements.txt            # ì˜ì¡´ì„± ì„¤ì¹˜
â”œâ”€â”€ utils.py.                   # í™˜ê²½ ë³€ìˆ˜ ê²€ì¦Â·ê²€ìƒ‰ ê²°ê³¼ UI
â”œâ”€â”€ main.py.                    # Streamlit ì‹¤í–‰ ì§„ì…ì 
â”œâ”€â”€ server.py.                  # FastAPI ì„œë²„ ì‹¤í–‰ ì§„ì…ì 
â””â”€â”€ README.md                 
```

## ğŸ› ï¸ ì‚¬ì „ ì¤€ë¹„
1. **Python 3.9+** ì„¤ì¹˜  
2. ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
   ```
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   ```
3. ì˜ì¡´ì„± ì„¤ì¹˜
   ```
   pip install -r requirements.txt
   ```
4. `.env` íŒŒì¼ì— ì„¤ì •

## ğŸš€ ì‹¤í–‰ ë°©ë²•
ìŠ¤íŠ¸ë¦¼ì‡ ì‹¤í–‰
```
streamlit run main.py
```
api ì„œë²„ ì‹¤í–‰
```
python server.py
```

## ğŸ–¥ï¸ UI ê¸°ëŠ¥
| íƒ­ | ì„¤ëª… |
| --- | --- |
| ğŸ“ Text Search | ìì—°ì–´ ì¿¼ë¦¬ë¡œ ìƒí’ˆ ê²€ìƒ‰ |
| ğŸ–¼ï¸ Image Search | ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ì™€ ìœ ì‚¬í•œ ìƒí’ˆ ê²€ìƒ‰ |
| ğŸ”€ Multimodal Search | í…ìŠ¤íŠ¸+ì´ë¯¸ì§€ ë™ì‹œ ì¡°ê±´ ê²€ìƒ‰ (Î± ìŠ¬ë¼ì´ë”ë¡œ ê°€ì¤‘ì¹˜ ì¡°ì ˆ) |

## ğŸ—„ï¸ Firestore ìŠ¤í‚¤ë§ˆ
- **ìƒí’ˆ ì»¬ë ‰ì…˜** (ì˜ˆ: `products`)  
  | í•„ë“œ | íƒ€ì… | ì„¤ëª… |
  | --- | --- | --- |
  | id | string | ë°”ì½”ë“œÂ·ê³ ìœ  ID |
  | product_name | string | ìƒí’ˆëª… |
  | image_url | string | ìƒí’ˆ ì´ë¯¸ì§€ URL |
  | is_emb | string | ì„ë² ë”© ìƒíƒœ (`R` = ëŒ€ê¸°, `D` = ì™„ë£Œ) |
  | ... | ... | ì¶”ê°€ ë©”íƒ€ë°ì´í„° |

- **ë²¡í„° ì»¬ë ‰ì…˜** (ì˜ˆ: `product_vectors`)  
  | í•„ë“œ | íƒ€ì… | ì„¤ëª… |
  | --- | --- | --- |
  | id | string | ìƒí’ˆ ID (FK) |
  | text_embedding | vector<float> | 1,024-ì°¨ì› í…ìŠ¤íŠ¸ ì„ë² ë”© |
  | image_embedding | vector<float> | 1,024-ì°¨ì› ì´ë¯¸ì§€ ì„ë² ë”© |

## âš™ï¸ ì£¼ìš” ëª¨ë“ˆ ìš”ì•½
1. `JinaCLIPEmbedding`  
   - í…ìŠ¤íŠ¸Â·ì´ë¯¸ì§€ ì„ë² ë”© ìƒì„±  
   - GPU ìë™ ê°ì§€ ë° `bfloat16` ì§€ì›
2. `FirestoreVectorDB`  
   - ë²¡í„° ì‚½ì…Â·ì—…ë°ì´íŠ¸, Dot Product ìœ ì‚¬ë„ ê¸°ë°˜ ê²€ìƒ‰  
   - ìƒí’ˆ ë©”íƒ€ë°ì´í„° ì¡°ì¸
3. `MultimodalRAGSystem`  
   - í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ ì¸í„°í˜ì´ìŠ¤  
   - ë©€í‹°ëª¨ë‹¬ ì‹œ Î± ê°’ìœ¼ë¡œ ê°€ì¤‘ í‰ê·  í›„ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ì •ë ¬
4. `utils`  
   - í™˜ê²½ ë³€ìˆ˜ ê²€ì¦, ê²€ìƒ‰ ê²°ê³¼ ìŠ¤íŠ¸ë¦¼ë¦¿ UI
5. `main`  
   - ìŠ¤íŠ¸ë¦¼ë¦¿ í˜ì´ì§€Â·ì‚¬ì´ë“œë°”Â·íƒ­ êµ¬ì„±  
   - ìœ ì € ì…ë ¥ ì²˜ë¦¬ ë° ê²°ê³¼ í‘œì‹œ

## âš™ï¸ API
1. ì„œë²„ ìƒíƒœ
   - `/health` : ì„œë²„ ìƒíƒœ í™•ì¸
2. ë²¡í„° ê²€ìƒ‰
   - `/search/text` : ìƒí’ˆ í…ìŠ¤íŠ¸ ê²€ìƒ‰
   - `/search/image` : ìƒí’ˆ ì´ë¯¸ì§€ ê²€ìƒ‰
   - `/search/multimodal` : ìƒí’ˆ í…ìŠ¤íŠ¸+ì´ë¯¸ì§€ ê²€ìƒ‰
3. íŒŒì´ì–´ìŠ¤í† ì–´ ì—…ë°ì´íŠ¸
   - `/start-index` : íŒŒì´ì–´ìŠ¤í† ì–´ ì¸ë±ìŠ¤ ìƒì„±(is_emb : R->D, ë²¡í„° í•„ë“œ ìƒì„±)
